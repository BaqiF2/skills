---
name: 完成前验证
description: 在提交代码或创建 Pull Request 之前，当即将声称工作已完成、已修复或通过时，必须运行验证命令并确认输出结果后才能做出任何成功声明；证据必须在任何断言之前出现
---

# 完成前验证

## 概述

在没有验证的情况下声称工作已完成，是不诚实，而非高效。

**核心原则：证据先行，始终如一。**

**违反此规则的字面含义，即等同于违背其精神。**

## 铁律

```
未进行最新验证的证据，不得做出完成声明
```

如果你没有在本消息中运行验证命令，你就不能声称其已通过。

## 门禁机制

```
在做出任何状态声明或表达满意之前：

1. 明确识别：哪条命令能证明该声明？
2. 执行：完整运行该命令（全新、完整）
3. 阅读：查看完整输出，检查退出码，统计失败项
4. 验证：输出是否证实了该声明？
   - 若否：明确实际状态，并提供证据
   - 若是：确认该声明并附上证据
5. 仅在此之后：做出该声明

跳过任何一步 = 说谎，而非验证
```

## 常见错误

| 声明 | 需要 | 不足 |
|------|------|------|
| 测试通过 | 测试命令输出：0 个失败 | 上一次运行结果，或“应通过” |
| 代码检查无误 | 代码检查命令输出：0 个错误 | 部分检查，或推断 |
| 构建成功 | 构建命令：退出码为 0 | 代码检查通过，日志看起来良好 |
| 问题已修复 | 原始症状测试：通过 | 代码已变更，但假设已修复 |
| 回归测试有效 | 已验证红绿循环 | 测试仅通过一次 |
| 代理任务完成 | 版本控制系统（VCS）差异显示变更 | 代理报告“成功” |
| 需求已满足 | 逐条检查清单 | 测试通过 |

## 红色警报 - 停止！

- 使用“应该”、“可能”、“看起来”
- 在验证前表达满意（“太棒了！”、“完美！”、“完成！”等）
- 未进行验证就准备提交/推送/创建 PR
- 信任代理的成功报告
- 依赖部分验证
- 思考“这次就例外”
- 疲惫并想放弃工作
- **任何暗示成功却未运行验证的表述**

## 防止合理化借口

| 借口 | 现实 |
|------|------|
| “现在应该能工作” | 必须运行验证 |
| “我很有信心” | 自信 ≠ 证据 |
| “这次就例外” | 无例外 |
| “代码检查通过” | 代码检查 ≠ 编译器 |
| “代理说成功了” | 必须独立验证 |
| “我累了” | 疲惫 ≠ 免责理由 |
| “部分检查就够了” | 部分检查毫无证明力 |
| “用的是不同说法，所以规则不适用” | 必须遵循精神而非字面 |

## 关键模式

**测试：**
```
✅ [运行测试命令] [看到：34/34 通过] “所有测试通过”
❌ “现在应该通过” / “看起来正确”
```

**回归测试（TDD 红绿循环）：**
```
✅ 编写 → 运行（通过）→ 撤销修复 → 运行（必须失败）→ 恢复 → 运行（通过）
❌ “我已经写了回归测试”（未进行红绿循环验证）
```

**构建：**
```
✅ [运行构建] [看到：退出码为 0] “构建通过”
❌ “代码检查通过”（代码检查不检查编译）
```

**需求满足：**
```
✅ 重新阅读计划 → 创建检查清单 → 验证每一项 → 报告缺口或完成情况
❌ “测试通过，阶段完成”
```

**代理委托：**
```
✅ 代理报告成功 → 检查 VCS 差异 → 验证变更 → 报告实际状态
❌ 信任代理报告
```

## 为什么这很重要

基于 24 次失败经历：
- 你的同事说：“我不相信你”——信任被破坏
- 发布了未定义函数——会导致崩溃
- 发布了缺失需求——功能不完整
- 花费时间在虚假完成上 → 转向 → 重做
- 违反了：“诚实是核心价值观。如果你说谎，你将被替换。”

## 何时适用

**始终在以下情况之前：**
- 任何成功/完成声明的变体
- 任何满意表达
- 任何对工作状态的积极陈述
- 提交代码、创建 PR、任务完成
- 转向下一个任务
- 委托给代理

**该规则适用于：**
- 精确短语
- 同义表达或改写
- 成功的隐含含义
- 任何暗示完成或正确的沟通内容

## 总结

**验证过程没有捷径。**

运行命令，阅读输出，然后才能做出结果声明。

这是不可协商的。